# ğŸ  Há»‡ thá»‘ng Quáº£n lÃ½ PhÃ²ng trá»

[![Java](https://img.shields.io/badge/Java-17+-orange.svg)](https://www.oracle.com/java/)
[![Spring](https://img.shields.io/badge/Spring-MVC-green.svg)](https://spring.io/)
[![MySQL](https://img.shields.io/badge/MySQL-8.0+-blue.svg)](https://www.mysql.com/)
[![Bootstrap](https://img.shields.io/badge/Bootstrap-5.3-purple.svg)](https://getbootstrap.com/)

Há»‡ thá»‘ng quáº£n lÃ½ phÃ²ng trá» hiá»‡n Ä‘áº¡i Ä‘Æ°á»£c xÃ¢y dá»±ng báº±ng Spring MVC, tÃ­ch há»£p thanh toÃ¡n MoMo vÃ  thÃ´ng bÃ¡o SMS.

## âœ¨ TÃ­nh nÄƒng chÃ­nh

### ğŸ‘¥ Quáº£n lÃ½ ngÆ°á»i dÃ¹ng
- âœ… ÄÄƒng kÃ½, Ä‘Äƒng nháº­p vá»›i validation
- âœ… PhÃ¢n quyá»n Admin/User
- âœ… Quáº£n lÃ½ thÃ´ng tin cÃ¡ nhÃ¢n
- âœ… Há»‡ thá»‘ng tin nháº¯n ná»™i bá»™

### ğŸ¢ Quáº£n lÃ½ phÃ²ng trá»
- âœ… CRUD phÃ²ng vá»›i validation
- âœ… Theo dÃµi tráº¡ng thÃ¡i phÃ²ng (Trá»‘ng/ÄÃ£ thuÃª)
- âœ… Quáº£n lÃ½ giÃ¡ phÃ²ng vÃ  sá»©c chá»©a
- âœ… Dashboard thá»‘ng kÃª

### ğŸ  Quáº£n lÃ½ ngÆ°á»i thuÃª
- âœ… ThÃªm ngÆ°á»i thuÃª vá»›i gÃ¡n dá»‹ch vá»¥ tá»± Ä‘á»™ng
- âœ… TÃ­nh toÃ¡n prorated theo ngÃ y á»Ÿ thá»±c táº¿
- âœ… Quáº£n lÃ½ thá»i gian thuÃª vÃ  lá»‹ch sá»­
- âœ… Khá»Ÿi táº¡o chá»‰ sá»‘ cÃ´ng tÆ¡ tá»± Ä‘á»™ng

### âš¡ Quáº£n lÃ½ dá»‹ch vá»¥
- âœ… Quáº£n lÃ½ dá»‹ch vá»¥ (Ä‘iá»‡n, nÆ°á»›c, internet, v.v.)
- âœ… Theo dÃµi chá»‰ sá»‘ cÃ´ng tÆ¡
- âœ… TÃ­nh toÃ¡n chi phÃ­ tá»± Ä‘á»™ng
- âœ… BÃ¡o cÃ¡o sá»­ dá»¥ng dá»‹ch vá»¥

### ğŸ’° Quáº£n lÃ½ hÃ³a Ä‘Æ¡n
- âœ… Táº¡o hÃ³a Ä‘Æ¡n tá»± Ä‘á»™ng theo phÃ²ng
- âœ… TÃ­nh toÃ¡n prorated chÃ­nh xÃ¡c
- âœ… Theo dÃµi tráº¡ng thÃ¡i thanh toÃ¡n
- âœ… **TÃ­ch há»£p MoMo QR Code** ğŸ”¥
- âœ… **ThÃ´ng bÃ¡o Email tá»± Ä‘á»™ng** ğŸ“§
- âœ… BÃ¡o cÃ¡o doanh thu chi tiáº¿t

### ğŸ’³ Thanh toÃ¡n MoMo
- âœ… Táº¡o QR Code tá»± Ä‘á»™ng sau khi táº¡o hÃ³a Ä‘Æ¡n
- âœ… Xá»­ lÃ½ callback vÃ  IPN
- âœ… Cáº­p nháº­t tráº¡ng thÃ¡i thanh toÃ¡n real-time
- âœ… TÃ¡i táº¡o QR Code khi cáº§n

### ğŸ“§ ThÃ´ng bÃ¡o Email
- âœ… Gá»­i Email tá»± Ä‘á»™ng khi táº¡o hÃ³a Ä‘Æ¡n
- âœ… TÃ­ch há»£p Gmail SMTP
- âœ… Template email HTML Ä‘áº¹p máº¯t
- âœ… **Bao gá»“m mÃ£ QR MoMo Ä‘á»™ng** ğŸ”¥
- âœ… Há»— trá»£ gá»­i Ä‘áº¿n nhiá»u ngÆ°á»i thuÃª

## ğŸ› ï¸ CÃ´ng nghá»‡ sá»­ dá»¥ng

- **Backend**: Java 17 + Spring MVC
- **Database**: MySQL 8.0+
- **Frontend**: JSP + Bootstrap 5.3
- **Payment**: MoMo Sandbox API
- **Email**: Gmail SMTP
- **Build Tool**: Maven 3.6+
- **Server**: Apache Tomcat 10+

## ğŸš€ CÃ i Ä‘áº·t

### YÃªu cáº§u há»‡ thá»‘ng
- â˜‘ï¸ Java 17+
- â˜‘ï¸ MySQL 8.0+
- â˜‘ï¸ Apache Tomcat 10+
- â˜‘ï¸ Maven 3.6+
- â˜‘ï¸ MoMo Sandbox Account (optional)
- â˜‘ï¸ Gmail Account vá»›i App Password (optional)

### HÆ°á»›ng dáº«n cÃ i Ä‘áº·t

1. **Clone repository**
   ```bash
   git clone <repository-url>
   cd QuanLyPhongTro
   ```

2. **Táº¡o database**
   ```sql
   CREATE DATABASE quan_ly_phong_tro;
   ```

3. **Import database schema**
   ```bash
   mysql -u root -p quan_ly_phong_tro < database/quan_ly_phong_tro_complete.sql
   ```

4. **Cáº¥u hÃ¬nh database connection**
   Chá»‰nh sá»­a file `src/main/java/util/DBConnection.java`:
   ```java
   private static final String DB_URL = "jdbc:mysql://localhost:3306/quan_ly_phong_tro";
   private static final String DB_USERNAME = "your_username";
   private static final String DB_PASSWORD = "your_password";
   ```

5. **Cáº¥u hÃ¬nh MoMo (Optional)**
   Chá»‰nh sá»­a file `src/main/java/config/MoMoConfig.java`:
   ```java
   public static final String PARTNER_CODE = "your_partner_code";
   public static final String ACCESS_KEY = "your_access_key";
   public static final String SECRET_KEY = "your_secret_key";
   ```

6. **Cáº¥u hÃ¬nh Gmail SMTP (Optional)**
   Chá»‰nh sá»­a file `src/main/java/config/GmailConfig.java`:
   ```java
   public static final String GMAIL_USERNAME = "your-email@gmail.com";
   public static final String GMAIL_PASSWORD = "your-app-password";
   public static final String FROM_EMAIL = "your-email@gmail.com";
   ```

7. **Build project**
   ```bash
   mvn clean compile
   ```

8. **Deploy to Tomcat**
   - Copy file WAR tá»« `target/` vÃ o thÆ° má»¥c `webapps/` cá»§a Tomcat
   - Hoáº·c deploy trá»±c tiáº¿p tá»« IDE

9. **Truy cáº­p á»©ng dá»¥ng**
   ```
   http://localhost:8080/QuanLyPhongTro
   ```

## ğŸ‘¤ TÃ i khoáº£n máº·c Ä‘á»‹nh

### Admin
- **Username**: `admin`
- **Password**: `admin123`
- **Quyá»n**: Quáº£n lÃ½ toÃ n bá»™ há»‡ thá»‘ng

### User
- **Username**: `user`
- **Password**: `user123`
- **Quyá»n**: Xem thÃ´ng tin phÃ²ng vÃ  hÃ³a Ä‘Æ¡n

## ğŸ“ Cáº¥u trÃºc project

```
QuanLyPhongTro/
â”œâ”€â”€ src/main/java/
â”œâ”€â”€ config/         # Configuration Classes
â”‚   â”œâ”€â”€ MoMoConfig.java
â”‚   â””â”€â”€ GmailConfig.java
â”‚   â”œâ”€â”€ controller/     # Spring MVC Controllers
â”‚   â”‚   â”œâ”€â”€ BillController.java
â”‚   â”‚   â”œâ”€â”€ MoMoPaymentController.java
â”‚   â”‚   â””â”€â”€ ...
â”‚   â”œâ”€â”€ dao/           # Data Access Objects
â”‚   â”‚   â”œâ”€â”€ MoMoDAO.java
â”‚   â”‚   â”œâ”€â”€ GmailDAO.java
â”‚   â”‚   â””â”€â”€ ...
â”‚   â”œâ”€â”€ model/         # Entity Models
â”‚   â”‚   â”œâ”€â”€ MoMoRequest.java
â”‚   â”‚   â”œâ”€â”€ EmailRequest.java
â”‚   â”‚   â”œâ”€â”€ EmailResponse.java
â”‚   â”‚   â””â”€â”€ ...
â”‚   â””â”€â”€ util/          # Utility Classes
â”œâ”€â”€ src/main/webapp/
â”‚   â”œâ”€â”€ WEB-INF/views/ # JSP Views
â”‚   â””â”€â”€ resources/     # Static Resources
â”œâ”€â”€ database/          # SQL Scripts
â”‚   â”œâ”€â”€ quan_ly_phong_tro.sql
â”‚   â””â”€â”€ quan_ly_phong_tro_complete.sql
â”œâ”€â”€ MOMO_INTEGRATION_GUIDE.md
â””â”€â”€ pom.xml           # Maven Configuration
```

## ğŸ”— API Endpoints

### Authentication
- `GET /login` - Trang Ä‘Äƒng nháº­p
- `POST /login` - Xá»­ lÃ½ Ä‘Äƒng nháº­p
- `GET /register` - Trang Ä‘Äƒng kÃ½
- `POST /register` - Xá»­ lÃ½ Ä‘Äƒng kÃ½
- `GET /logout` - ÄÄƒng xuáº¥t

### Admin
- `GET /admin/dashboard` - Dashboard admin
- `GET /admin/rooms` - Quáº£n lÃ½ phÃ²ng
- `GET /admin/tenants` - Quáº£n lÃ½ ngÆ°á»i thuÃª
- `GET /admin/services` - Quáº£n lÃ½ dá»‹ch vá»¥
- `GET /admin/bills` - Quáº£n lÃ½ hÃ³a Ä‘Æ¡n
- `GET /admin/bills/generate` - Táº¡o hÃ³a Ä‘Æ¡n

### User
- `GET /user/dashboard` - Dashboard user
- `GET /user/room` - ThÃ´ng tin phÃ²ng
- `GET /user/invoices` - HÃ³a Ä‘Æ¡n cá»§a tÃ´i
- `GET /user/payments` - Lá»‹ch sá»­ thanh toÃ¡n

### MoMo Payment
- `GET /payment/momo/return` - Xá»­ lÃ½ return tá»« MoMo
- `POST /payment/momo/notify` - Xá»­ lÃ½ IPN tá»« MoMo
- `POST /payment/momo/regenerate-qr/{invoiceId}` - Táº¡o QR má»›i

## ğŸ¯ TÃ­nh nÄƒng ná»•i báº­t

### ğŸ’° TÃ­nh toÃ¡n Prorated chÃ­nh xÃ¡c
- Tá»± Ä‘á»™ng tÃ­nh tiá»n phÃ²ng theo ngÃ y á»Ÿ thá»±c táº¿
- Há»— trá»£ tenant chuyá»ƒn vÃ o giá»¯a thÃ¡ng
- TrÃ¡nh sai sá»‘ lÃ m trÃ²n

### ğŸ“§ ThÃ´ng bÃ¡o Email tá»± Ä‘á»™ng
- Template email HTML Ä‘áº¹p máº¯t vá»›i thÃ´ng tin chi tiáº¿t
- Hiá»ƒn thá»‹ thÃ´ng tin phÃ²ng, ká»³ thanh toÃ¡n vÃ  sá»‘ tiá»n
- **TÃ­ch há»£p mÃ£ QR MoMo Ä‘á»™ng** - QuÃ©t Ä‘á»ƒ thanh toÃ¡n ngay
- Gá»­i tá»± Ä‘á»™ng Ä‘áº¿n táº¥t cáº£ ngÆ°á»i thuÃª trong phÃ²ng
- Há»— trá»£ hiá»ƒn thá»‹ tiáº¿ng Viá»‡t

### ğŸ’³ MoMo QR Code
- Tá»± Ä‘á»™ng táº¡o QR sau khi táº¡o hÃ³a Ä‘Æ¡n
- Cáº­p nháº­t tráº¡ng thÃ¡i thanh toÃ¡n real-time
- Há»— trá»£ tÃ¡i táº¡o QR khi cáº§n

### ğŸ“Š Dashboard thá»‘ng kÃª
- Doanh thu theo thÃ¡ng/nÄƒm
- Tá»· lá»‡ láº¥p Ä‘áº§y phÃ²ng
- Top dá»‹ch vá»¥ Ä‘Æ°á»£c sá»­ dá»¥ng
- BÃ¡o cÃ¡o chi tiáº¿t

## ğŸ”§ Cáº¥u hÃ¬nh Production

### MoMo Production
1. ÄÄƒng kÃ½ tÃ i khoáº£n MoMo Business
2. Cáº­p nháº­t credentials trong `MoMoConfig.java`
3. Thay Ä‘á»•i endpoint tá»« sandbox sang production
4. Cáº¥u hÃ¬nh domain thá»±c táº¿ cho callback URLs

### Gmail SMTP Production
1. Táº¡o Gmail App Password
2. Cáº­p nháº­t thÃ´ng tin Ä‘Äƒng nháº­p trong GmailConfig.java
3. Kiá»ƒm tra cáº¥u hÃ¬nh SMTP
4. Test vá»›i email thá»±c

### Security
- Sá»­ dá»¥ng HTTPS cho production
- Báº£o máº­t database credentials
- Validate táº¥t cáº£ input
- Implement rate limiting

## ğŸ› Troubleshooting

### Database Connection
```bash
# Kiá»ƒm tra MySQL service
sudo systemctl status mysql

# Kiá»ƒm tra port
netstat -tlnp | grep :3306
```

### MoMo Integration
- Kiá»ƒm tra credentials
- Verify callback URLs accessible
- Check signature validation

### Email Integration
- Kiá»ƒm tra Gmail App Password
- XÃ¡c nháº­n Ä‘á»‹a chá»‰ email há»£p lá»‡
- Test vá»›i cÃ¡c nhÃ  cung cáº¥p email khÃ¡c nhau

## ğŸ“ˆ Roadmap

- [ ] Mobile app (React Native)
- [ ] Email notifications
- [ ] Advanced reporting
- [ ] Multi-language support
- [ ] API documentation (Swagger)
- [ ] Docker containerization

## ğŸ¤ ÄÃ³ng gÃ³p

1. Fork repository
2. Táº¡o feature branch (`git checkout -b feature/AmazingFeature`)
3. Commit changes (`git commit -m 'Add some AmazingFeature'`)
4. Push to branch (`git push origin feature/AmazingFeature`)
5. Táº¡o Pull Request

## ğŸ“„ License

Project nÃ y Ä‘Æ°á»£c phÃ¢n phá»‘i dÆ°á»›i MIT License. Xem file `LICENSE` Ä‘á»ƒ biáº¿t thÃªm chi tiáº¿t.

## ğŸ“ LiÃªn há»‡

Náº¿u cÃ³ báº¥t ká»³ cÃ¢u há»i nÃ o, vui lÃ²ng liÃªn há»‡:
- ğŸ“§ Email: your.email@example.com
- ğŸ™ GitHub: [your-username](https://github.com/your-username)
- ğŸ’¬ Issues: [GitHub Issues](https://github.com/your-username/QuanLyPhongTro/issues)

---

â­ **Náº¿u project nÃ y há»¯u Ã­ch, hÃ£y cho má»™t star nhÃ©!** â­